#!/bin/bash

IFS=$'\n'
urldecode(){
  echo -e "$(sed 's/+/ /g; s/%/\\x/g')"
}


CYAN=`tput setaf 6`;
BRIGHT=`tput bold`;
CYAN=`tput setaf 6`
NORMAL=`tput sgr0`
REVERSE=`tput smso`
column=`tput cols`;
echo -e  "$REVERSE $1 $NORMAL";

if [ ! $MICRO_LANG ]
 then
  MICRO_LANG=en
fi


function status() {
#printf("\n",$MICRO_LANG);
echo -e  "$REVERSE self=$0 $NORMAL";
echo -e  "$REVERSE arg=$1 $NORMAL";
echo -e  "$REVERSE width=$column $NORMAL";
echo -e  "$REVERSE lang=$MICRO_LANG $NORMAL";

#printf("%".$column,"%s");
return
} ;

search=$1;
#search=$(perl -e "print ucfirst($search)")  ;
nogo="http:\/\/|Articles|Artikel|Wikipedia|Commons|Tracking_|Hidden_|Talk_|_talk|Use_dmy_dates|_Diskussion|Pages_containing "
#search=$(perl -e "print ucfirst($search)");
#status;
function getcat(){
q="http://$MICRO_LANG.wikipedia.org/wiki/$1";
 mojo get -M POST  "$q" a  attr href   | egrep "^\/wiki\/(Category|Kategorie)" | egrep -vi "("$nogo")" |   sort | sed -s "s/\/wiki\///"
#for i in ` mojo get -M HEAD  "$q" a  attr href   | egrep "^\/wiki\/(Category|Kategorie)" | egrep -vi "("$nogo")" |   sort | sed -s "s/\/wiki\///"`; do q=$i;   echo $i | urldecode; done
}
# status $1

getcat $1
#qq=$(echo "$search" | sed "s/^.*.://" | tr "_" "|");
#q=$1; cat=$(for i in `getcat "$q"`; do getcat "$i"; done); echo "$cat" | data-freq | egrep -v "http" |  sed -s "s/^.*.: //" | egrep -i "($qq)"
#q=$1; cat=$(for i in `getcat "$q"`; do qq=$(echo "$q" | sed -s "s/^.*.\://");  getcat "$i"; done);    echo "$cat" | egrep -vi "http:" | data-freq | sort -n
#echo -e "\n"
