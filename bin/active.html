<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

<script>

 function xSend(message)
 {

      var sendMessage = document.getElementById("sendMessage");

      document.getElementById("sendMessage").value=message;

     // xSent(message);


 }

 function iterateAttributesAndFormHTMLLabels(o){
 var s = '';
 var xi = 0;

 $("#todo-list").append('<li onclick="xSend(this.value);"><span class="todo-content" tabindex="'+xi+'">[<b style="color:black;">'+o.spawn+'</b><span style="color:blue;" >'+o.neighbour+'</span></span>   <span style="float:right;"><img src="http://127.0.0.1:5984/app/_design/base/tiny-right.png"></span></li>');

 return s;
}


</script
<html>
<head>
<title>You are not alone</title>
</head>
<body bgcolor="#000044" text="#ffffcc">
<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
<tr>
<td>>
  <nav>  </nav>  <div id="main-container">  <strong>Message&nabla;</strong><strong style="margin:100px;display:inline;zoom:1.1M;">Location&nabla;</strong><br>  <div id="main">  <div id="webSocketSupp"></div>  <div style="display:none;" id="noWebSocketSupp">  <div style="float: left;">  </div>  <div style="float: left; width: 60px; margin-left: 1px;">  <p>Uh-oh, the browser you're using doesn't have native support for WebSocket. That means you can't run this demo.</p>  <p>The following link lists the browsers that support WebSocket:</p>  </div>  </div>  <div id="echo">  <div id="echo-config" >  <input id="sendMessage" size="35" value="" class="yui3-aclist-input" aria-autocomplete="list" aria-expanded="false" aria-owns="yui_3_6_0_2_1347698521800_36" autocomplete="off">  <input id="wsUri" size="13" value="ws://127.0.0.1:3000" disabled="">  <input type="checkbox" id="secureCb" onclick="toggleTls();" style="display:none;" disabled="">  <span id="secureCbLabel" style="font-size: smaller; color: rgb(153, 153, 153); display:none;">Use secure WebSocket (TLS)</span><br>  <button id="connect" disabled="">Connect</button>  <button id="disconnect">Disconnect</button>  <button id="clearLogBut">Clear log</button>  <button id="send" class="box">Send</button>  <br>  <br> <code id="echo-log" style="float: left; margin-left: 20px; padding-left: 20px;width:58%; min-width: 900px; border-left: solid 1px #cccccc;"> <pre> <strong>Log:</strong> <div id="consoleLog"></div> </pre> </code>  </div>  <div class="clearfix"></div>

 <script>
 var secureCb;
 var secureCbLabel;
 var wsUri;
 var consoleLog;
 var connectBut;
 var disconnectBut;
 var sendMessage;
 var sendBut;
 var clearLogBut;
 function echoHandlePageLoad()
 {
 if (window.WebSocket)
 {
 document.getElementById("webSocketSupp").style.display = "block";
 }
 else
 {
 document.getElementById("noWebSocketSupp").style.display = "block";
 }
 secureCb = document.getElementById("secureCb");
 secureCb.checked = false;
 secureCb.onclick = toggleTls;
 secureCbLabel = document.getElementById("secureCbLabel")
 wsUri = document.getElementById("wsUri");
 toggleTls();
 connectBut = document.getElementById("connect");
 connectBut.onclick = doConnect;
 disconnectBut = document.getElementById("disconnect");
 disconnectBut.onclick = doDisconnect;
 sendMessage = document.getElementById("sendMessage");
 sendBut = document.getElementById("send");
 sendBut.onclick = doSend;
 consoleLog = document.getElementById("consoleLog");
 clearLogBut = document.getElementById("clearLogBut");
 clearLogBut.onclick = clearLog;
 setGuiConnected(false);
 document.getElementById("disconnect").onclick = doDisconnect;
 document.getElementById("send").onclick = doSend;
 }
 function toggleTls()
 {
 var wsPort = (window.location.port.toString() === "" ? "" : ":"+window.location.port)
 if (wsUri.value === "") {
 wsUri.value = "ws://" + window.location.hostname.replace("www", "echo") + wsPort;
 }
 if (secureCb.checked)
 {
 wsUri.value = wsUri.value.replace("ws:", "wss:");
 }
 else
 {
 wsUri.value = wsUri.value.replace ("wss:", "ws:");
 }
 }
 function doConnect()
 {
 if (window.MozWebSocket)
 {
 logToConsole('<span style="color: red;"><strong>Info:</strong> This browser supports WebSocket using the MozWebSocket constructor</span>');
 window.WebSocket = window.MozWebSocket;
 }
 else if (!window.WebSocket)
 {
 logToConsole('<span style="color: red;"><strong>Error:</strong> This browser does not have support for WebSocket</span>');
 return;
 }
 // prefer text messages
 var uri = wsUri.value;
 if (uri.indexOf("?") == -1) {
 uri += "?encoding=text";
 } else {
 uri += "&encoding=text";
 }
 websocket = new WebSocket(uri);
 websocket.onopen = function(evt) { onOpen(evt) };
 websocket.onclose = function(evt) { onClose(evt) };
 websocket.onmessage = function(evt) { onMessage(evt) };
 websocket.onerror = function(evt) { onError(evt) };
 }
 function doDisconnect()
 {
 websocket.close()
 }
 function doSend()
 {

 logToConsole("SENT: " + sendMessage.value);
 websocket.send(sendMessage.value);
 }
 function writeElem(message,i){
 var xmessage = '<li class="todo-view"><span class="todo-content" tabindex="'+i+'">'+message+'</span></div></li>';
 $("#todo-list").append(xmessage);
 }
 function logToConsole(message)
 {
 var pre = document.createElement("p");
 pre.style.wordWrap = "break-word";
 pre.innerHTML = getSecureTag()+message;
 consoleLog.appendChild(pre);
 while (consoleLog.childNodes.length > 50)
 {
 consoleLog.removeChild(consoleLog.firstChild);
 }
 consoleLog.scrollTop = consoleLog.scrollHeight;
 }
 function onOpen(evt)
 {
 logToConsole("CONNECTED");
 setGuiConnected(true);
 }
 function onClose(evt)
 {
 logToConsole("DISCONNECTED");
 setGuiConnected(false);
 }
 function onMessage(evt)
 {
 if(evt.data.match("{")){
 var elem = JSON.parse(evt.data.toString());
 var xlist = elem.responce[0];
 $("#todo-list").empty();

 for(a in xlist){
iterateAttributesAndFormHTMLLabels(xlist[a]);
 }}
 }
 function onError(evt)
 {
 logToConsole('<span style="color: red;">ERROR:</span> ' + evt.data);
 }
 function setGuiConnected(isConnected)
 {
 wsUri.disabled = isConnected;
 connectBut.disabled = isConnected;
 disconnectBut.disabled = !isConnected;
 sendMessage.disabled = !isConnected;
 sendBut.disabled = !isConnected;
 secureCb.disabled = isConnected;
 var labelColor = "black";
 if (isConnected)
 {
 labelColor = "#999999";
 }
 secureCbLabel.style.color = labelColor;
 }
 function clearLog()
 {
 while (consoleLog.childNodes.length > 0)
 {
 consoleLog.removeChild(consoleLog.lastChild);
 }
 $("#todo-list").empty();
 }
 function getSecureTag()
 {
 if (secureCb.checked)
 {
 return 'lock';
 }
 else
 {
 return '';
 }
 }
 window.addEventListener("load", echoHandlePageLoad, false);
 </script>
 <script>
 $('#webSocketSupp').fadeIn(250);
 setTimeout(function(){$('#webSocketSupp').fadeOut(250,function(){
 document.getElementById("connect").click();
 $('#webSocketSupp').remove();
 $('#connect').click(1);
 })},250);
 </script>

 </div>  </div> <ul id="todo-list"> </ul> </div></div></body></html>

</body>
</html>


</td>
<td align="center">
<table border="0" cellpadding="0" cellspacing="0">
<tr>
<td>
<font size="-1">
<pre>
                          ;;;;;;iiiii;;
                 i!!!!!!!!!!!!!!!~{:!!!!i
             i!~!!))!!!!!!!!!!!!!!!!!!!!!!!!
          i!!!{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!i
       i!!)!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    '!h!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  '!!`!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!i
   /!!!~!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
' ':)!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  ~:!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
..!!!!!\!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 `!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
 ~ ~!!!)!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!~
~~'~{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!:'~
{-{)!!{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!:!
`!!!!{!~!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!':!!!
' {!!!{>)`!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!)!~..
:!{!!!{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -!!:
    ~:!4~/!!!!!!!!!!!!!!!!!!!~!!!!!!!!!!!!!!!!!!!!!!!!!!
     :~!!~)(!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
      ``~!!).~!!!!!!!!!!!!!{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!:
            ~  '!\!!!!!!!!!!(!!!!!!!!!!!!!!!!!!!!!!4!!!~:
           '      '--`!!!!!!!!/:\!!{!!((!~.~!!`?~-      :
              ``-.    `~!{!`)(>~/ \~                   :
   .                \  : `{{`. {-   .-~`              /
    .          !:       .\\?.{\   :`      .          :!
    \ :         `      -~!{:!!!\ ~     :!`         .>!
    '  ~          '    '{!!!{!!!t                 ! !!
     '!  !.            {!!!!!!!!!              .~ {~!
      ~!!..`~:.       {!!!!!!!!!!:          .{~ :LS{
       `!!!!!!h:!?!!!!!!!!!!!!!(!!!!::..-~~` {!!!!.
         4!!!!!!!!!!!!!!!!!!!!!~!{!~!!!!!!!!!!!!'
          `!!!!!!!!!!!!!!!!!!!!(~!!!!!!!!!!!!!~
            `!!!!!!!!!!!{\``!!``(!!!!!!!!!~~  .
             `!!!!!!!!!!!!!!!!!!!!!!!!(!:
               .!!!!!!!!!!!!!!!!!!!!!\~
               .`!!!!!!!/`.;;~;;`~!! '
                 -~!!!!!!!!!!!!!(!!/ .
                    `!!!!!!!!!!!!!!'
                      `\!!!!!!!!!~

</pre>
</font>
</td>
</tr>
</table>
</td>
</tr>
</table>
